<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASCII Petals — Style Guide</title>
  <style>
    /* Site-adjacent palette (mirrors _sass/_style.scss essentials) */
    :root {
      --room: #141210;           /* site deep background */
      --charcoal: #201d1a;       /* warm charcoal */
      --graphite: #2d2926;       /* graphite borders */
      --stone: #4a453f;          /* stone accents */
      --cream: #e8ddd4;          /* warm cream text */
      --warm-gray: #c7beb5;
      --accent: #3b82f6;         /* primary blue */
      --accent2: #93c5fd;        /* lighter blue */
      --paper-default: #EEE8DE;  /* softer paper base */
      --paper-muted: #E7E0D6;    /* muted paper */
      --paper-warm:  #F0E6D6;    /* lamp-warm paper */
      --paper-fiber: #EDE6DA;    /* handmade paper */
    }

    html, body { height: 100%; margin: 0; background: var(--room); color: var(--cream); font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 24px; }
    h1 { font-size: 1.8rem; margin: 0 0 8px; }
    p.lead { margin: 0 0 24px; color: var(--warm-gray); }

    .gallery { display: grid; gap: 24px; grid-template-columns: 1fr; }
    @media (min-width: 900px) { .gallery { grid-template-columns: 1fr 1fr; } }

    .specimen { position: relative; display: grid; place-items: center; padding: 18px; border-radius: 14px; }
    .specimen .pane { position: relative; border-radius: 12px; }
    .specimen canvas { width: min(88vmin, 600px); height: min(88vmin, 600px); aspect-ratio: 1/1; display: block; border-radius: 12px; background: var(--paper, var(--paper-default)); }
    .caption { margin-top: 10px; color: var(--warm-gray); font-size: 0.95rem; }

    /* Variant 0: Plain — no defined background, uses page backdrop */
    .v-plain { background: transparent; border: none; box-shadow: none; }
    .v-plain { --paper: transparent; }
    .v-plain canvas { box-shadow: none; }

    /* Variant 1: Noir Invert — bright lines on deep charcoal */
    .v-noir { background: var(--charcoal); border: 1px solid color-mix(in oklab, var(--graphite) 70%, var(--charcoal)); box-shadow: none; }
    .v-noir { --paper: #151311; }
    .v-noir canvas { box-shadow: none; }

    /* Variant 2: Indigo Night — cool night gradient, blue glyphs */
    .v-indigo { background: radial-gradient(120% 120% at 50% 40%, rgba(18,24,32,0.6), transparent 70%), #0f1115; border: 1px solid #151821; box-shadow: none; }
    .v-indigo { --paper: #0f1218; }
    .v-indigo canvas { box-shadow: none; }

    /* Variant 3: Sepia Desk — dark sepia with vignette and grain */
    .v-sepia { background: #17120d; border: 1px solid #1b1610; box-shadow: none; position: relative; }
    .v-sepia::after { content: none; }
    .v-sepia { --paper: #1d1610; }
    .v-sepia .pane::before { content: none; }

    /* Utility: labels */
    .label { position: absolute; top: 10px; left: 12px; color: var(--stone); font: 12px/1.2 ui-monospace, Menlo, monospace; opacity: .8; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ASCII Petals — Style Guide</h1>
    <p class="lead">Two pairs of editions: Cream (plain + framed) and Blue (plain + framed). This page serves as the reference for the animation color palette and presentation styles. No drop shadows; framed versions use only simple background + 1px border.</p>

    <div class="gallery">
      <!-- 0. Plain / Ambient -->
      <section class="specimen v-plain" style="--paper: transparent; --accent: #ffffff; --accent2: #e8ddd4;">
        <span class="label">Plain — Cream</span>
        <div class="pane"><canvas width="920" height="920" aria-label="ASCII petals — plain with site background"></canvas></div>
        <div class="caption">No frame or paper; bright cream/white glyphs on the site background.</div>
      </section>

      <!-- 1. Noir Invert -->
      <section class="specimen v-noir" style="--paper: #151311; --accent: #ffffff; --accent2: #e8ddd4;">
        <span class="label">Noir — Framed Cream</span>
        <div class="pane"><canvas width="920" height="920" aria-label="ASCII petals — white lines on deep charcoal"></canvas></div>
        <div class="caption">Bright cream/white glyphs on deep charcoal paper; crisp, minimal.</div>
      </section>

      <!-- 2. Plain / Ambient — Blue -->
      <section class="specimen v-plain" style="--paper: transparent; --accent: #3b82f6; --accent2: #93c5fd;">
        <span class="label">Plain — Blue</span>
        <div class="pane"><canvas width="920" height="920" aria-label="ASCII petals — plain with blue glyphs"></canvas></div>
        <div class="caption">No frame or paper; blue glyphs on the site background.</div>
      </section>

      <!-- 3. Indigo — Framed Blue -->
      <section class="specimen v-indigo" style="--paper: #0f1218; --accent: #3b82f6; --accent2: #93c5fd;">
        <span class="label">Indigo — Framed Blue</span>
        <div class="pane"><canvas width="920" height="920" aria-label="ASCII petals — indigo framed blue"></canvas></div>
        <div class="caption">Cool indigo surround with restrained blue glyphs; low glare.</div>
      </section>
    </div>
  </div>

  <script>
    // Multi-canvas renderer using the same algorithm as ascii-petals-kaizen
    const specimens = Array.from(document.querySelectorAll('.specimen'));
    const views = specimens.map(section => {
      const canvas = section.querySelector('canvas');
      const ctx = canvas.getContext('2d');
      return { section, canvas, ctx };
    });

    const BASE_GRID = 60;
    const cell = 14; const cw = cell * 0.72; const ch = cell;
    const CHARS = ['/', '\\', '|'];
    let t = 0, animId;

    function col(scopeEl, name, fallback){
      // read CSS variables from the variant section, fallback to root
      const fromScope = getComputedStyle(scopeEl).getPropertyValue(name).trim();
      if (fromScope) return fromScope;
      const fromRoot = getComputedStyle(document.documentElement).getPropertyValue(name).trim();
      return fromRoot || fallback;
    }

    function renderCanvas(view, time){
      const { section, canvas, ctx } = view;
      const tLocal = time;
      const paper = col(section, '--paper', '#EEE8DE');
      const a1 = col(section, '--accent', '#3b82f6');
      const a2 = col(section, '--accent2', '#93c5fd');

      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = paper; ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.font = `${cell}px ui-monospace, Menlo, monospace`;
      ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
      const cx = canvas.width/2, cy = canvas.height/2;

      // Subtle evolving params
      const GRID_SIZE = BASE_GRID + Math.floor(Math.sin(tLocal*0.25)*2); // ±2
      const threshold = 0.28 + 0.08*Math.sin(tLocal*0.18 + 1.3);
      const fadeEdge = 0.84 + 0.02*Math.cos(tLocal*0.21);

      // Pre-parse accent colors
      const [r1,g1,b1] = hexToRgb(a1) || [59,130,246];
      const [r2,g2,b2] = hexToRgb(a2) || [147,197,253];

      for(let y=0;y<GRID_SIZE;y++){
        for(let x=0;x<GRID_SIZE;x++){
          const w1 = Math.sin((x+y)/4 + tLocal);
          const w2 = Math.cos((x - y)/4 - tLocal*0.7);
          const bx = Math.abs(x-GRID_SIZE/2)/(GRID_SIZE/2);
          const by = Math.abs(y-GRID_SIZE/2)/(GRID_SIZE/2);
          const boundary = Math.max(bx,by);
          if(boundary >= fadeEdge) continue;
          const fade = 1 - boundary/fadeEdge;
          const v = (w1*0.6 + w2*0.4) * fade;
          let char = '';
          if (v > threshold) char = CHARS[0];
          else if (v < -threshold) char = CHARS[1];
          else if (Math.abs(v) < 0.08) char = CHARS[2];
          if (!char) continue;
          const xp = cx + (x-GRID_SIZE/2)*cw;
          const yp = cy + (y-GRID_SIZE/2)*ch;

          // pulse color toward accents at rhythm peaks
          const pulse = (Math.sin(tLocal*0.6) + 1)/2; // 0..1
          const a = 0.7 + 0.3*pulse;
          const r = Math.round(r1 + (r2-r1)*pulse);
          const g = Math.round(g1 + (g2-g1)*pulse);
          const b = Math.round(b1 + (b2-b1)*pulse);
          ctx.fillStyle = `rgba(${r},${g},${b},${a})`;
          ctx.fillText(char, xp, yp);
        }
      }
    }

    function frame(){
      for(const v of views){ renderCanvas(v, t); }
      t += 0.007;
      animId = requestAnimationFrame(frame);
    }

    function hexToRgb(hex){
      const m = (hex||'').trim().match(/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);
      if(!m) return null; return [parseInt(m[1],16), parseInt(m[2],16), parseInt(m[3],16)];
    }

    const reduce = matchMedia('(prefers-reduced-motion: reduce)');
    if (!reduce.matches) frame(); else for(const v of views){ renderCanvas(v, 0); }
    reduce.addEventListener('change', (e)=>{
      if(e.matches && animId) { cancelAnimationFrame(animId); for(const v of views){ renderCanvas(v, 0); } }
      else if(!e.matches) frame();
    });
  </script>
</body>
</html>


